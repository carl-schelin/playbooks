#!/bin/ksh

if [[ -z $1 ]]
then
  echo "Need to pass in the management route"
  exit 1
fi

if [[ -z $2 ]]
then
  echo "Need to pass in the management device"
  exit 1
fi

if [[ ! -f routes ]]
then
  echo "The 'routes' file doesn't exist"
  exit 1
fi

echo "Verifying route information"
for i in `cat routes | sed -e "s/    Route to //g" -e "s/ missing.//g"`
do
  grep $i /opt/intrado/.config
done

echo ""
echo "Listing route definitions"
for i in `cat routes | sed -e "s/    Route to //g" -e "s/ missing.//g"`
do
  echo "route add -host $i/32 gw $1 dev $2; echo \"$i/32 via $1 dev $2\" >> /etc/sysconfig/network-scripts/route-$2"
done

rm routes
