#!/bin/ksh

# Run the pwck utility to validate the /etc/passwd and /etc/shadow files

#BASENAME=$(basename "${0}")
DIRNAME=$(dirname "${0}")

if [[ ! -f ${DIRNAME}/../.config ]]
then
  echo "Unable to locate ${DIRNAME}/../.config. Exiting."
  exit 1
fi

# Source the configuration file
. "${DIRNAME}"/../.config

ID=$(id | cut -f1 -d\( | cut -f2 -d=)

if [[ ! $ID = 0 ]]
then
  echo "You must be root to run this script"
  exit 1
fi

if [[ -f ${SCRIPTS_LOGS}/pwck.output ]]
then
  rm "${SCRIPTS_LOGS}/pwck.output"
fi

# create a blank file to stop the complaining of the morning report
touch "${SCRIPTS_LOGS}/pwck.output"

if [[ $OS = "Linux" ]]
then
  /usr/sbin/pwck > "${SCRIPTS_LOGS}/pwck.output" 2>&1
fi
if [[ $OS = "SunOS" ]]
then
  /usr/sbin/pwck > "${SCRIPTS_LOGS}/pwck.output" 2>&1
fi
if [[ $OS = "HP-UX" ]]
then
  /usr/sbin/pwck > "${SCRIPTS_LOGS}/pwck.output" 2>&1
fi
if [[ $OS = "OSF1" ]]
then
  /usr/sbin/pwck > "${SCRIPTS_LOGS}/pwck.output" 2>&1
fi

exit 0

