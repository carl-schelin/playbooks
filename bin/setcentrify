#!/bin/ksh

# KevinZupan
# Check certain centrify settings or file options and change them to what we want

OS=`uname`
INTRADO='/opt/intrado'
ID=`id | cut -f1 -d\( | cut -f2 -d=`
OUTPUT=$INTRADO/etc/setcentrify.output

if [[ ! $ID = 0 ]]
then
  echo "You must be root to run this script"
  exit 1
fi

if [[ -f $OUTPUT ]]
then
  rm $OUTPUT
fi

# create a blank file to stop the complaining of the morning report
touch $OUTPUT

set -A DISABLE_FILES '/usr/share/centrifydc/libexec/adcert' \
                     '/usr/share/centrifydc/mappers/machine/certgp.pl' \
                     '/usr/share/centrifydc/mappers/machine/rhel_certgp.pl'

for DISFILE in ${DISABLE_FILES[@]}; do
  if [[ -x $DISFILE ]]; then
    chmod a-x $DISFILE
    echo "$DISFILE execution bit removed" >> $OUTPUT
  fi
done

exit 0

